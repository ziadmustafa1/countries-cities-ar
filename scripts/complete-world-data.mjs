import fs from 'fs';

console.log('๐ ุฏูุฌ ูู ุจูุงูุงุช ุงูุนุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช...\n');

// ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
const dbCountries = JSON.parse(
  fs.readFileSync('countries-states-cities-database/json/countries.json', 'utf-8')
);

const dbStates = JSON.parse(
  fs.readFileSync('countries-states-cities-database/json/states.json', 'utf-8')
);

// ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ
const africaData = fs.readFileSync('src/data/africa.ts', 'utf-8');
const americasData = fs.readFileSync('src/data/americas.ts', 'utf-8');
const asiaData = fs.readFileSync('src/data/asia.ts', 'utf-8');
const europeData = fs.readFileSync('src/data/europe.ts', 'utf-8');
const oceaniaData = fs.readFileSync('src/data/oceania.ts', 'utf-8');

// ุชุฌููุน ุงููุญุงูุธุงุช ุญุณุจ ุงูุฏููุฉ
const statesByCountry = {};
dbStates.forEach(state => {
  const code = state.country_code;
  if (!statesByCountry[code]) {
    statesByCountry[code] = [];
  }
  statesByCountry[code].push({
    name: state.name,
    nameAr: state.name_native || state.name,
    nameFr: state.name // ุณูุญุชุงุฌ ูุฅุถุงูุฉ ุงูุชุฑุฌูุฉ ุงููุฑูุณูุฉ ูุงุญูุงู
  });
});

// ุงูุชุฑุฌูุงุช ุงูุนุฑุจูุฉ ุงููุนุฑููุฉ ููุฏูู
const arabicCountryNames = {
  'AF': 'ุฃูุบุงูุณุชุงู',
  'AL': 'ุฃูุจุงููุง',
  'DZ': 'ุงูุฌุฒุงุฆุฑ',
  'AS': 'ุณุงููุง ุงูุฃูุฑูููุฉ',
  'AD': 'ุฃูุฏูุฑุง',
  'AO': 'ุฃูุบููุง',
  'AI': 'ุฃูุบููุง',
  'AQ': 'ุงููุงุฑุฉ ุงููุทุจูุฉ ุงูุฌููุจูุฉ',
  'AG': 'ุฃูุชูุบูุง ูุจุงุฑุจูุฏุง',
  'AR': 'ุงูุฃุฑุฌูุชูู',
  'AM': 'ุฃุฑููููุง',
  'AW': 'ุฃุฑูุจุง',
  'AU': 'ุฃุณุชุฑุงููุง',
  'AT': 'ุงูููุณุง',
  'AZ': 'ุฃุฐุฑุจูุฌุงู',
  'BS': 'ุงูุจุงูุงูุง',
  'BH': 'ุงูุจุญุฑูู',
  'BD': 'ุจูุบูุงุฏูุด',
  'BB': 'ุจุฑุจุงุฏูุณ',
  'BY': 'ุฑูุณูุง ุงูุจูุถุงุก',
  'BE': 'ุจูุฌููุง',
  'BZ': 'ุจููุฒ',
  'BJ': 'ุจููู',
  'BM': 'ุจุฑููุฏุง',
  'BT': 'ุจูุชุงู',
  'BO': 'ุจูููููุง',
  'BA': 'ุงูุจูุณูุฉ ูุงููุฑุณู',
  'BW': 'ุจูุชุณูุงูุง',
  'BR': 'ุงูุจุฑุงุฒูู',
  'BN': 'ุจุฑููุงู',
  'BG': 'ุจูุบุงุฑูุง',
  'BF': 'ุจูุฑูููุง ูุงุณู',
  'BI': 'ุจูุฑููุฏู',
  'KH': 'ููุจูุฏูุง',
  'CM': 'ุงููุงููุฑูู',
  'CA': 'ููุฏุง',
  'CV': 'ุงูุฑุฃุณ ุงูุฃุฎุถุฑ',
  'KY': 'ุฌุฒุฑ ูุงููุงู',
  'CF': 'ุฌูููุฑูุฉ ุฃูุฑูููุง ุงููุณุทู',
  'TD': 'ุชุดุงุฏ',
  'CL': 'ุชุดููู',
  'CN': 'ุงูุตูู',
  'CO': 'ูููููุจูุง',
  'KM': 'ุฌุฒุฑ ุงูููุฑ',
  'CG': 'ุงููููุบู',
  'CD': 'ุฌูููุฑูุฉ ุงููููุบู ุงูุฏูููุฑุงุทูุฉ',
  'CR': 'ููุณุชุงุฑููุง',
  'CI': 'ุณุงุญู ุงูุนุงุฌ',
  'HR': 'ูุฑูุงุชูุง',
  'CU': 'ููุจุง',
  'CY': 'ูุจุฑุต',
  'CZ': 'ุงูุชุดูู',
  'DK': 'ุงูุฏููุงุฑู',
  'DJ': 'ุฌูุจูุชู',
  'DM': 'ุฏููููููุง',
  'DO': 'ุฌูููุฑูุฉ ุงูุฏููููููุงู',
  'EC': 'ุงูุฅููุงุฏูุฑ',
  'EG': 'ูุตุฑ',
  'SV': 'ุงูุณููุงุฏูุฑ',
  'GQ': 'ุบูููุง ุงูุงุณุชูุงุฆูุฉ',
  'ER': 'ุฅุฑูุชุฑูุง',
  'EE': 'ุฅุณุชูููุง',
  'ET': 'ุฅุซููุจูุง',
  'FJ': 'ููุฌู',
  'FI': 'ููููุฏุง',
  'FR': 'ูุฑูุณุง',
  'GA': 'ุงูุบุงุจูู',
  'GM': 'ุบุงูุจูุง',
  'GE': 'ุฌูุฑุฌูุง',
  'DE': 'ุฃููุงููุง',
  'GH': 'ุบุงูุง',
  'GR': 'ุงููููุงู',
  'GD': 'ุบุฑููุงุฏุง',
  'GT': 'ุบูุงุชููุงูุง',
  'GN': 'ุบูููุง',
  'GW': 'ุบูููุง ุจูุณุงู',
  'GY': 'ุบูุงูุง',
  'HT': 'ูุงูุชู',
  'HN': 'ููุฏูุฑุงุณ',
  'HU': 'ุงููุฌุฑ',
  'IS': 'ุขูุณููุฏุง',
  'IN': 'ุงูููุฏ',
  'ID': 'ุฅูุฏูููุณูุง',
  'IR': 'ุฅูุฑุงู',
  'IQ': 'ุงูุนุฑุงู',
  'IE': 'ุฃูุฑููุฏุง',
  'IL': 'ุฅุณุฑุงุฆูู',
  'IT': 'ุฅูุทุงููุง',
  'JM': 'ุฌุงูุงููุง',
  'JP': 'ุงููุงุจุงู',
  'JO': 'ุงูุฃุฑุฏู',
  'KZ': 'ูุงุฒุงุฎุณุชุงู',
  'KE': 'ููููุง',
  'KI': 'ููุฑูุจุงุชู',
  'KP': 'ููุฑูุง ุงูุดูุงููุฉ',
  'KR': 'ููุฑูุง ุงูุฌููุจูุฉ',
  'KW': 'ุงููููุช',
  'KG': 'ููุฑุบูุฒุณุชุงู',
  'LA': 'ูุงูุณ',
  'LV': 'ูุงุชููุง',
  'LB': 'ูุจูุงู',
  'LS': 'ููุณูุชู',
  'LR': 'ููุจูุฑูุง',
  'LY': 'ููุจูุง',
  'LI': 'ููุฎุชูุดุชุงูู',
  'LT': 'ููุชูุงููุง',
  'LU': 'ูููุณูุจูุฑุบ',
  'MK': 'ููุฏูููุง ุงูุดูุงููุฉ',
  'MG': 'ูุฏุบุดูุฑ',
  'MW': 'ูุงูุงูู',
  'MY': 'ูุงููุฒูุง',
  'MV': 'ุฌุฒุฑ ุงููุงูุฏูู',
  'ML': 'ูุงูู',
  'MT': 'ูุงูุทุง',
  'MH': 'ุฌุฒุฑ ูุงุฑุดุงู',
  'MR': 'ููุฑูุชุงููุง',
  'MU': 'ููุฑูุดููุณ',
  'MX': 'ุงูููุณูู',
  'FM': 'ูููุฑูููุฒูุง',
  'MD': 'ูููุฏููุง',
  'MC': 'ูููุงูู',
  'MN': 'ููุบูููุง',
  'ME': 'ุงูุฌุจู ุงูุฃุณูุฏ',
  'MA': 'ุงููุบุฑุจ',
  'MZ': 'ููุฒูุจูู',
  'MM': 'ููุงููุงุฑ',
  'NA': 'ูุงููุจูุง',
  'NR': 'ูุงูุฑู',
  'NP': 'ููุจุงู',
  'NL': 'ููููุฏุง',
  'NZ': 'ูููุฒูููุฏุง',
  'NI': 'ูููุงุฑุงุบูุง',
  'NE': 'ุงูููุฌุฑ',
  'NG': 'ููุฌูุฑูุง',
  'NO': 'ุงููุฑููุฌ',
  'OM': 'ุณูุทูุฉ ุนููุงู',
  'PK': 'ุจุงูุณุชุงู',
  'PW': 'ุจุงูุงู',
  'PS': 'ููุณุทูู',
  'PA': 'ุจููุง',
  'PG': 'ุจุงุจูุง ุบูููุง ุงูุฌุฏูุฏุฉ',
  'PY': 'ุจุงุฑุงุบูุงู',
  'PE': 'ุจูุฑู',
  'PH': 'ุงูููุจูู',
  'PL': 'ุจูููุฏุง',
  'PT': 'ุงูุจุฑุชุบุงู',
  'QA': 'ูุทุฑ',
  'RO': 'ุฑููุงููุง',
  'RU': 'ุฑูุณูุง',
  'RW': 'ุฑูุงูุฏุง',
  'KN': 'ุณุงูุช ููุชุณ ูููููุณ',
  'LC': 'ุณุงูุช ููุณูุง',
  'VC': 'ุณุงูุช ููุณูุช ูุงูุบุฑููุงุฏูู',
  'WS': 'ุณุงููุง',
  'SM': 'ุณุงู ูุงุฑููู',
  'ST': 'ุณุงู ุชููู ูุจุฑููุณูุจู',
  'SA': 'ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ',
  'SN': 'ุงูุณูุบุงู',
  'RS': 'ุตุฑุจูุง',
  'SC': 'ุณูุดู',
  'SL': 'ุณูุฑุงูููู',
  'SG': 'ุณูุบุงููุฑุฉ',
  'SK': 'ุณูููุงููุง',
  'SI': 'ุณููููููุง',
  'SB': 'ุฌุฒุฑ ุณูููุงู',
  'SO': 'ุงูุตููุงู',
  'ZA': 'ุฌููุจ ุฃูุฑูููุง',
  'SS': 'ุฌููุจ ุงูุณูุฏุงู',
  'ES': 'ุฅุณุจุงููุง',
  'LK': 'ุณุฑููุงููุง',
  'SD': 'ุงูุณูุฏุงู',
  'SR': 'ุณูุฑููุงู',
  'SZ': 'ุฅุณูุงุชููู',
  'SE': 'ุงูุณููุฏ',
  'CH': 'ุณููุณุฑุง',
  'SY': 'ุณูุฑูุง',
  'TW': 'ุชุงููุงู',
  'TJ': 'ุทุงุฌููุณุชุงู',
  'TZ': 'ุชูุฒุงููุง',
  'TH': 'ุชุงููุงูุฏ',
  'TL': 'ุชูููุฑ ุงูุดุฑููุฉ',
  'TG': 'ุชูุบู',
  'TO': 'ุชููุบุง',
  'TT': 'ุชุฑูููุฏุงุฏ ูุชูุจุงุบู',
  'TN': 'ุชููุณ',
  'TR': 'ุชุฑููุง',
  'TM': 'ุชุฑููุงูุณุชุงู',
  'TV': 'ุชููุงูู',
  'UG': 'ุฃูุบูุฏุง',
  'UA': 'ุฃููุฑุงููุง',
  'AE': 'ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ',
  'GB': 'ุงูููููุฉ ุงููุชุญุฏุฉ',
  'US': 'ุงูููุงูุงุช ุงููุชุญุฏุฉ',
  'UY': 'ุงูุฃูุฑูุบูุงู',
  'UZ': 'ุฃูุฒุจูุณุชุงู',
  'VU': 'ูุงููุงุชู',
  'VA': 'ุงููุงุชููุงู',
  'VE': 'ููุฒูููุง',
  'VN': 'ููุชูุงู',
  'YE': 'ุงูููู',
  'ZM': 'ุฒุงูุจูุง',
  'ZW': 'ุฒููุจุงุจูู',
  // ุฅุถุงูุงุช
  'AX': 'ุฌุฒุฑ ุฃููุงูุฏ',
  'BQ': 'ุจูููุฑ ูุณุงูุช ุฃูุณุชุงุชููุณ ูุณุงุจุง',
  'CW': 'ููุฑุงุณุงู',
  'GU': 'ุบูุงู',
  'JE': 'ุฌูุฑุณู',
  'XK': 'ููุณููู',
  'RE': 'ุฑูููููู',
  'BL': 'ุณุงู ุจุงุฑุชูููู',
  'SX': 'ุณุงูุช ูุงุฑุชู',
  'TC': 'ุฌุฒุฑ ุชูุฑูุณ ููุงูููุณ',
  'VI': 'ุฌุฒุฑ ุงูุนุฐุฑุงุก ุงูุฃูุฑูููุฉ'
};

// ุชุญุถูุฑ ุงูุจูุงูุงุช ุงููุงููุฉ
const completeWorldData = {
  missingCountries: [],
  updatedCountries: [],
  totalStates: 0
};

// ูุนุงูุฌุฉ ูู ุฏููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
dbCountries.forEach(dbCountry => {
  const code = dbCountry.iso2;
  const states = statesByCountry[code] || [];
  
  if (states.length > 0) {
    const countryData = {
      code: code,
      name: dbCountry.name,
      nameAr: arabicCountryNames[code] || dbCountry.native || dbCountry.name,
      nameFr: dbCountry.name, // ูููู ุชุญุณูููุง ูุงุญูุงู
      region: dbCountry.region,
      subregion: dbCountry.subregion,
      statesCount: states.length,
      states: states
    };
    
    // ุชุญุฏูุฏ ุฅุฐุง ูุงูุช ุงูุฏููุฉ ููุฌูุฏุฉ ูู ุฃู ููู
    const isInAfrica = africaData.includes(`"code": "${code}"`);
    const isInAmericas = americasData.includes(`"code": "${code}"`);
    const isInAsia = asiaData.includes(`"code": "${code}"`);
    const isInEurope = europeData.includes(`"code": "${code}"`);
    const isInOceania = oceaniaData.includes(`"code": "${code}"`);
    
    if (!isInAfrica && !isInAmericas && !isInAsia && !isInEurope && !isInOceania) {
      completeWorldData.missingCountries.push(countryData);
    } else {
      completeWorldData.updatedCountries.push(countryData);
    }
    
    completeWorldData.totalStates += states.length;
  }
});

// ุญูุธ ุงูุจูุงูุงุช ุงููุงููุฉ
fs.writeFileSync(
  'output/complete-world-data.json',
  JSON.stringify(completeWorldData, null, 2),
  'utf-8'
);

console.log('๐ ุงููุชุงุฆุฌ:');
console.log(`   ุฏูู ููููุฏุฉ: ${completeWorldData.missingCountries.length}`);
console.log(`   ุฏูู ููุชุญุฏูุซ: ${completeWorldData.updatedCountries.length}`);
console.log(`   ุฅุฌูุงูู ุงููุญุงูุธุงุช: ${completeWorldData.totalStates}`);

// ุฅูุดุงุก ุณูุฑูุจุช ูุฅุถุงูุฉ ุงูุฏูู ุงูููููุฏุฉ
const missingByRegion = {
  'Africa': [],
  'Americas': [],
  'Asia': [],
  'Europe': [],
  'Oceania': []
};

completeWorldData.missingCountries.forEach(country => {
  const region = country.region || 'Other';
  if (missingByRegion[region]) {
    missingByRegion[region].push(country);
  }
});

console.log('\n๐ ุงูุฏูู ุงูููููุฏุฉ ุญุณุจ ุงูููุทูุฉ:');
Object.keys(missingByRegion).forEach(region => {
  if (missingByRegion[region].length > 0) {
    console.log(`\n${region}:`);
    missingByRegion[region].forEach(c => {
      console.log(`   - ${c.nameAr} (${c.code}): ${c.statesCount} ูุญุงูุธุฉ`);
    });
  }
});

// ุฅูุดุงุก ููู ููุฏูู ุงูููููุฏุฉ ูุน ูุญุงูุธุงุชูุง
fs.writeFileSync(
  'output/missing-countries.json',
  JSON.stringify(missingByRegion, null, 2),
  'utf-8'
);

console.log('\nโ ุชู ุญูุธ ุงูุจูุงูุงุช ูู:');
console.log('   - output/complete-world-data.json');
console.log('   - output/missing-countries.json');
